FROM python:3.12-slim

WORKDIR /app

# Install all required dependencies
RUN pip install --only-binary=:all: --no-cache-dir \
    grpcio==1.74.0 \
    protobuf==6.31.1 \
    httpx==0.27.2 \
    requests==2.32.3

# Copy the scaler code and gRPC stubs
COPY external_scaler.py external_scaler.proto ./
COPY external_scaler_pb2.py external_scaler_pb2_grpc.py ./

# Run the scaler
CMD ["python", "external_scaler.py"]

